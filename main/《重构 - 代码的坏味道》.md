## 重构的原则

From [重构 - 改善既有代码的设计]()

### 神秘命名

如果你想不出一个好名字，说明背后可能潜藏着更深的设计问题。为一个恼人名字所付出的纠结，常常能推动我们对代码进行精简。

### 重复代码

阅读重复的代码时必须加倍仔细，留意其间细微的差异。

### 过长函数

让小函数易于理解的关键还是在于良好的命名。如果你能给函数起个好名字，阅读代码的人就可以通过名字了解函数的作用，根本不必去看其中写了些什么。

关键在于函数“做什么”和“如何做”之间的语义距离。

每当感觉需要以注释来说明点什么的时候，我们就把需要说明的东西写进一个独立的函数中。如果代码前方有一行注释，就是在提醒你：可以将这段代码替换成一个函数。

庞大的`switch`语句，其中的每个分支都应该通过提炼函数变成独立的函数调用（或者多态）。

将循环和循环内的代码提炼到一个独立的函数中。如果你发现提炼出的循环很难命名，可能是因为其中做了几件**不同**的事，if so，拆分循环。

### 过长参数列表

**把函数所需的东西都以参数的形式传递进去**。

使用类可以有效地缩短参数列表。

### 全局数据

—— 是被来自地狱第四层的恶魔发明出来的。

把全局数据用一个函数包装起来。尽量控制其作用域。

### 可变数据

封装变量 / 拆分变量 / 移动语句 / 提炼函数 / 查询函数和修改函数分离 / 移除设值函数 / 查询取代派生变量 / 函数组合成类 / 函数组合成变换 / 引用对象改为值对象。

### 发散式变化

每次只关心一个上下文。

### 霰弹式修改

### 依恋情节

将总是一起变化的东西放在一块儿：数据和引用这些数据的行为总是一起变化的，但也有例外。如果例外出现，我们就搬移那些行为，保持变化只在一地发生。

### 数据泥团

如果删掉众多数据的一项，其他数据有没有因此而失去意义？如果他们不再有意义，这就是一个明确的信号：你应该为他们产生一个新对象。

### 基本类型偏执

创建对自己的问题域有用的基本类型：如钱、坐标、范围等。

一个体面的类型，至少能包含一致的显示逻辑，在用户界面上需要显示时可以使用。

### 重复的 `switch`

> 所有条件逻辑都应该用多态取代，绝大多是 `if` 语句都应该被扫进历史的垃圾桶。

### 循环语句

以管道取代循环。管道操作可以帮助我们更快地看清被处理的元素以及处理它们的动作。

### 冗赘的元素

### 夸夸其谈通用性

### 临时字段

### 过长的消息链

### 中间人

对象的基本特征之一就是封装 —— 对外部世界隐藏其内部细节。

### 内幕交易

不要在模块之间大量交换数据，这会增加模块之间的耦合。尽量减少不可避免的数据交换或者吧这种交换都放到明面上来。

如果两个模块有共同的兴趣，可以尝试再新建一个模块，把这些共用的数据放在一个管理良好的地方；或者用隐藏委托关系来两一个模块变成两者的中介。

### 过大的类

将几个变量一起提炼至新类内。

把多余的东西消弭于类的内部。

如果使用者只用到了这个类所有功能的一个子集，每个这样的子集都可能拆分成一个独立的类。

### 异曲同工的类

### 纯数据类

> 纯数据类常常意味着行为被放在了错误的地方。（？）

### 被拒绝的遗赠

既然不愿意支持超类的接口，就不要虚情假意地糊弄继承体系。

### 注释

人们常常把注释当做“除臭剂”来使用。这些注释之所以存在是因为代码很糟糕。
