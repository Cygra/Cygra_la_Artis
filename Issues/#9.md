# å½“æˆ‘ä»¬ä½¿ç”¨ç®­å¤´å‡½æ•°() => {}çš„æ—¶å€™å‘ç”Ÿäº†ä»€ä¹ˆ

> ç®­å¤´å‡½æ•°ä¸åŒ¿åå‡½æ•°æœ€æ˜æ˜¾çš„åŒºåˆ«å³ä¸ºç®­å¤´å‡½æ•°ä¸ç»‘å®šè‡ªå·±çš„ `this`ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸Šä¸‹æ–‡çš„ `this`ã€‚

```javascript
function Clock(){
  this.sec = 0

  setInterval(() => {
    this.sec ++
  }, 1000)
}

var newClock = new Clock()
```

ç»è¿‡ Babel ç¼–è¯‘ä¹‹åï¼Œå¾—åˆ°ï¼š

```javascript
"use strict";

function Clock() {
  var _this = this;

  this.sec = 0;

  setInterval(function () {
    _this.sec++;
  }, 1000);
}

var newClock = new Clock();
```

å¯ä»¥çœ‹å‡ºï¼Œç»è¿‡ Babel ç¼–è¯‘åçš„ç®­å¤´å‡½æ•°ï¼Œåœ¨å…¶ä¸Šä¸‹æ–‡ä¸­å°†ä¸Šä¸‹æ–‡çš„ `this` èµ‹ç»™ä¸´æ—¶å˜é‡ `_this` ï¼Œå¹¶æ›¿æ¢ç®­å¤´å‡½æ•°å†…éƒ¨çš„ `this`ã€‚

æ‰€ä»¥ï¼Œå¯¹ç®­å¤´å‡½æ•°ä½¿ç”¨ `call()` æˆ–è€… `apply()` ä¼šè¢«å¿½ç•¥ã€‚

> ç®­å¤´å‡½æ•°ä¸å¯ä½œä¸ºæ„é€ å‡½æ•°ã€‚

å°†ä¸ŠèŠ‚çš„ `Clock` æ”¹å†™æˆå¦‚ä¸‹ç®­å¤´å‡½æ•°å½¢å¼ï¼š

```javascript
let Clock = () => {
  this.sec = 0

  setInterval(() => {
    this.sec ++
  }, 1000)
}

var newClock = new Clock()
```

å¹¶åœ¨ Chrome æµè§ˆå™¨çš„ console é‡Œç›´æ¥æ‰§è¡Œï¼Œä¼šå¾—åˆ°ï¼š

```
Uncaught TypeError: Clock is not a constructor
```

å°†ä»¥ä¸Šä»£ç ä½¿ç”¨ Babel ç¼–è¯‘å¯å¾—ï¼š

```javascript
"use strict";

var Clock = function Clock() {
  undefined.sec = 0;

  setInterval(function () {
    undefined.sec++;
  }, 1000);
};

var newClock = new Clock();
```

å¯è§ï¼ŒåŸæœ¬ç»‘å®š `Clock` çš„ `this` è¢«ç¼–è¯‘æˆäº† `undefined`ã€‚

> ç®­å¤´å‡½æ•°ä¸åŒ¿åå‡½æ•°æœ‰ä¸åŒçš„è§£æä¼˜å…ˆçº§ã€‚

```javascript
let foo

foo = foo || function() {} // ok

// callback = callback || () => {}
// this is not ok

foo = foo || (() => {}) // ok
```

ç»è¿‡ Babel ç¼–è¯‘åå¾—åˆ°ï¼š

```javascript
"use strict";

var foo = void 0;

foo = foo || function () {}; // ok

// callback = callback || () => {}
// this is not ok

foo = foo || function () {}; // ok
```

> ç®­å¤´å‡½æ•°æ”¯æŒ[é»˜è®¤å‚æ•°](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Default_parameters)ã€‚

```javascript
let foobar = (param1, param2 = "param2") => {
  console.log(param1)
  console.log(param2)
}

foobar(1)
// 1
// param2
```

Babelled ğŸ‘‡

```javascript
"use strict";

var foobar = function foobar(param1) {
  var param2 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : "param2";

  console.log(param1);
  console.log(param2);
};
```

> ç®­å¤´å‡½æ•°æ”¯æŒ[å‰©ä½™å‚æ•°](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/rest_parameters)ã€‚

```javascript
let arr = (...params) =>  {
  console.log(params)
}

arr(1, 2, 3)
// [1, 2, 3]
```

Babelled ğŸ‘‡

```javascript
"use strict";

var arr = function arr() {
  for (var _len = arguments.length, params = Array(_len), _key = 0; _key < _len; _key++) {
    params[_key] = arguments[_key];
  }

  console.log(params);
};

arr(1, 2, 3);
```